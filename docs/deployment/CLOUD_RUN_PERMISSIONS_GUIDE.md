# Cloud Run 権限設定の詳細手順

## 手順1: Cloud Runにアクセス

1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. 左上のプロジェクト選択で「**gym-reserve-app**」が選択されていることを確認
3. 左側のメニュー（ハンバーガーメニュー ☰）をクリック
4. メニューから「**Cloud Run**」を探してクリック
   - 場所: 「コンピューティング」セクション内
   - または、検索バーで「Cloud Run」と入力して検索

---

## 手順2: サービスを選択

1. Cloud Runのページに移動すると、サービス一覧が表示されます
2. サービス一覧から「**gym-reserve-app**」という名前のサービスを探します
3. 「**gym-reserve-app**」の行をクリック（サービス名のリンクをクリック）

---

## 手順3: 権限タブを開く

サービス詳細ページに移動すると、上部に以下のようなタブが並んでいます：

- **修正と新しいリビジョンのデプロイ**（または「リビジョン」）
- **ログ**
- **メトリック**
- **YAML**
- **権限** ← これをクリック

**「権限」タブが表示されない場合：**
- ページを少しスクロールしてみてください
- ブラウザの画面幅が狭い場合、タブが折り返されている可能性があります

---

## 手順4: 未認証アクセスを許可

「権限」タブを開くと、以下のような画面が表示されます：

1. 「**プリンシパルを追加**」ボタン（または「**アクセスを許可**」）をクリック
2. 以下のように入力：
   - **新しいプリンシパル**: `allUsers` と入力
   - **ロールを選択**: 「**Cloud Run 起動元**」を選択
     - または `Cloud Run Invoker` と表示される場合もあります
     - ドロップダウンメニューから選択できます
3. 「**保存**」ボタンをクリック
4. 確認ダイアログが表示されるので、「**確認**」をクリック

---

## 別の方法：コマンドラインで設定

GCPコンソールでの操作が難しい場合は、コマンドラインで設定できます：

```bash
gcloud run services add-iam-policy-binding gym-reserve-app \
  --region=asia-northeast1 \
  --member="allUsers" \
  --role="roles/run.invoker"
```

このコマンドを実行すると、同じ設定が適用されます。

---

## 確認方法

設定後、数秒待ってから、以下のURLにアクセス：

https://gym-reserve-app-1094873497912.asia-northeast1.run.app/

エラーが消えて、正常にページが表示されれば成功です。


