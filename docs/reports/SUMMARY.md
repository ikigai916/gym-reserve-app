# 機能・画面・Issue整理のまとめ

## 作成したドキュメント

### 1. specification.md（要件定義書）
完全な要件定義書（新要件に対応）
- 想定ユーザー（トレーナー/トレーニー）
- 機能要件（認証、プラン、決済、メニュー、予約、カルテ、管理）
- データモデル
- UI要件
- 技術要件
- 制約事項

### 2. SCREEN_FLOW.md（画面遷移図）
Mermaid形式の画面遷移図
- トレーニー向け画面遷移図
- トレーナー向け画面遷移図
- 主要なユーザーフロー（シーケンス図）
  - プラン購入から予約まで
  - カルテ記録
  - 予約キャンセル
- URLマッピング

### 3. NEW_REQUIREMENTS.md
新しい要件のまとめ
- 想定ユーザー（トレーナー/トレーニー）
- 主要機能（予約、メニュー、カルテ、管理）
- データモデル（想定）

### 2. FEATURE_LIST.md
機能一覧
- 現状の機能（実装済み）
- 新規要件の機能
- 実装優先度（フェーズ分け）

### 3. SCREEN_LIST.md
画面一覧
- トレーニー向け画面（6画面）
- トレーナー向け画面（8画面）
- 共通画面

### 4. ISSUE_REORGANIZATION.md
Issue整理方針
- 既存Issueの扱い
- 新規Issueの提案

### 5. SUMMARY.md（このファイル）
整理結果のまとめ

## 現在のIssue状況

### 既存Issue（維持・拡張が必要）

| Issue | タイトル | 状態 | 備考 |
|-------|---------|------|------|
| #3 | 予約データモデルの拡張 | OPEN | ✅ 更新済み：プランID、メニューID、トレーナーID、決済関連フィールド追加 |
| #4 | 時間枠機能の実装 | OPEN | メニューに応じた時間枠の動的表示も必要 |
| #5 | 予約キャンセル機能の実装 | OPEN | 維持 |
| #6 | ユーザー情報更新APIの実装 | OPEN | 維持 |
| #7 | マイページ機能の実装 | OPEN | ✅ 更新済み：プラン状況、カルテ履歴、決済履歴追加 |
| #8 | 予約一覧のフィルタリング機能 | OPEN | ✅ 更新済み：トレーナー向けフィルタリング、複数条件対応 |
| #9 | 予約バリデーションの強化 | OPEN | ✅ 更新済み：プラン残り回数、メニュー、トレーナー、ユーザープランの検証追加 |

### 新規Issue（新要件に基づく）

| Issue | タイトル | 状態 |
|-------|---------|------|
| #14 | 要件整理: 機能一覧・画面一覧・Issueの整理 | OPEN |
| #15 | ロール管理機能の実装（トレーナー/トレーニー） | OPEN |
| #16 | プラン機能の実装（60分4回、90分4回、120分4回） | OPEN |
| #17 | メニュー機能の実装（大カテゴリ：トレーニング、整体、鍼灸、温活、坐禅） | OPEN |
| #18 | カルテ機能の実装（大カテゴリ・中カテゴリで記録） | OPEN |
| #19 | 管理機能の実装（予約管理、顧客管理、プラン管理、メニュー管理） | OPEN |
| #20 | 決済機能の実装（Stripe連携） | OPEN |

## 主要機能の概要

### 1. 予約機能（拡張）
- プランベースの予約システム
  - 1ヶ月60分4回プラン
  - 1ヶ月90分4回プラン
  - 1ヶ月120分4回プラン
- メニュー選択（大カテゴリ）
- 時間枠選択

### 2. メニュー機能
- 大カテゴリ：トレーニング、整体、鍼灸、温活、坐禅
- メニュー別の所要時間設定

### 3. カルテ機能
- 大カテゴリ・中カテゴリで記録
- トレーナーが記録、トレーニーが閲覧

### 4. 管理機能
- 予約管理
- 顧客管理
- プラン管理
- メニュー管理

## 画面構成

### トレーニー向け（6画面）
1. ログイン/新規登録画面
2. 予約一覧/カレンダー画面
3. 予約作成画面
4. マイページ
5. マイ予約一覧画面
6. カルテ閲覧画面

### トレーナー向け（8画面）
1. トレーナーログイン画面
2. 予約管理画面（ダッシュボード）
3. 予約詳細画面
4. カルテ記録画面
5. カルテ編集画面
6. 顧客管理画面
7. プラン管理画面
8. メニュー管理画面

## 次のステップ

1. **既存Issueの更新**
   - Issue #3, #7, #8, #9 に新要件の内容を追加

2. **新規Issueの実装計画**
   - Issue #15（ロール管理）から着手
   - Issue #16（プラン機能）、#17（メニュー機能）を並行
   - Issue #18（カルテ機能）、#19（管理機能）を後続

3. **仕様書の更新**
   - specification.mdを新しい要件に合わせて更新

4. **データモデルの設計**
   - Plan, UserPlan, Menu, Chartのデータモデルを詳細化

