# 開発ワークフロー標準化ドキュメント

このドキュメントでは、CursorとClaude Codeを使用した再現可能な開発フローを定義します。

## 1. 要求整理フロー

### 1.1 Issue作成

カスタムコマンドを使用してIssueを作成します：

```
/github:issue-from-request "要求内容の説明"
```

**注意事項：**
- Issueの内容は日本語で記述する
- 明確な問題の概要、現在の動作、期待される動作を含める
- 影響範囲と関連ファイルを明記する

## 2. 初版作成フロー

### 2.1 ブランチ作成

Issue番号を指定してブランチを作成：

```
/github:branch-create {issue番号}
```

**ブランチ命名規則：**
- 機能追加: `feature/{issue番号}-{説明}`
- バグ修正: `fix/{issue番号}-{説明}`

### 2.2 実装前チェックリスト

実装を開始する前に、以下を確認：

- [ ] セキュリティチェックリストを確認（`SECURITY_CHECKLIST.md`参照）
- [ ] 関連する既存のドキュメントを確認
- [ ] 実装計画を立てる（Planモードを使用）

### 2.3 実装実行

1. **Planモードで計画を立てる**
   - CursorのPlanモードを使用
   - 実装手順を明確にする

2. **Buildモードで実装**
   - Planに基づいて実装を進める
   - セキュリティ設定を必ず確認

3. **動作確認**
   - ローカル環境で動作確認
   - セキュリティ設定が適切か確認

### 2.4 コミット作成

ステージング後、カスタムコマンドでコミット：

```
/github:commit-single
```

**コミットメッセージ規約：**
- Conventional Commit形式を使用
- 日本語で記述
- プレフィックス: `feat:`, `fix:`, `refactor:`, `docs:`, `style:`, `test:`, `chore:`

### 2.5 プルリクエスト作成

ブランチをpush後、PRを作成：

```
/github:pull-request-create main
```

**PR作成時の確認事項：**
- [ ] Issueと実装内容の差分がないか確認
- [ ] セキュリティチェックが完了しているか確認
- [ ] テストが通過しているか確認

## 3. レビュー対応フロー

### 3.1 レビュー実施

PRレビューを実施：

```
/github:pull-request-review
```

**レビュー観点：**
- 変更が冗長でないか
- デバッグコードなどの無駄なコードが残っていないか
- docs配下に変更点が反映されているか
- セキュリティ設定が適切か

### 3.2 レビュー対応

1. レビュー指摘事項を確認
2. Planモードで修正計画を立てる
3. Buildモードで修正を実施
4. 動作確認
5. コミット作成
6. 再レビュー（指摘がなくなるまで繰り返し）

## 4. マージ後の確認

### 4.1 デプロイ確認

- [ ] Cloud Runへのデプロイが成功しているか
- [ ] 本番環境で動作確認
- [ ] セキュリティ設定が本番環境で適切か確認

### 4.2 Issueクローズ確認

- [ ] Issueが自動的にクローズされているか確認
- [ ] 関連するドキュメントを更新

## 5. よくあるミスと対策

### 5.1 セキュリティ設定の見落とし

**問題：** CORS設定で `allow_origins=["*"]` のまま本番環境にデプロイ

**対策：** 実装前に `SECURITY_CHECKLIST.md` を確認し、環境変数で管理

### 5.2 ブランチを作成せずにmainで作業

**問題：** mainブランチで直接実装してしまう

**対策：** 実装前に必ず `/github:branch-create` でブランチを作成

### 5.3 コミットメッセージが不適切

**問題：** コミットメッセージが曖昧

**対策：** `/github:commit-single` を使用してConventional Commit形式を遵守

### 5.4 ドキュメント未更新

**問題：** コード変更したがドキュメントを更新していない

**対策：** レビュー時に `docs/` 配下の更新も確認

## 6. カスタムコマンド一覧

| コマンド | 用途 | 使用タイミング |
|---------|------|--------------|
| `/github:issue-from-request` | Issue作成 | 要求整理時 |
| `/github:branch-create` | ブランチ作成 | 実装開始前 |
| `/github:commit-single` | コミット作成 | 実装完了後 |
| `/github:pull-request-create` | PR作成 | コミット後 |
| `/github:pull-request-review` | PRレビュー | PR作成後 |

詳細は `CUSTOM_COMMANDS_SETUP.md` を参照してください。

---

## 7. 開発ルール

詳細な開発ルールについては、`DEVELOPMENT_RULES.md` を参照してください。

**重要なルール：**
- ドキュメントとコードの整合性を保つ（ルール1）
- 動作確認を必ず実施（ルール2）
- Issueと実装の整合性を確認（ルール3）
- コミットメッセージはConventional Commit形式（ルール4）
- 実装順序は優先度に従う（ルール5）
- エラーハンドリングとログを適切に実装（ルール7）

