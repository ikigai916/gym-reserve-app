# 機能一覧

## 現状の機能（実装済み）

### 基本機能
- [x] ユーザー登録・ログイン（簡易）
- [x] 予約作成（日付のみ）
- [x] 予約一覧表示（カレンダー）
- [x] 予約確認

### 実装済みの拡張機能
- [x] ロール管理機能（トレーナー/トレーニー）
  - ユーザー作成時にロールを設定
  - ログイン画面でロール選択UI
  - Userモデルにroleフィールド追加
- [x] 予約データモデルの拡張
  - userId, timeSlot, statusフィールド追加
  - trainerId, menuId, userPlanIdフィールド追加（Optional）
  - 新形式API（POST /api/reservations, GET /api/reservations）追加

## 新規要件の機能

### 1. 予約機能（拡張）

#### 1.1 プランベース予約システム
- [ ] プラン選択機能
  - 1ヶ月60分4回プラン
  - 1ヶ月90分4回プラン
  - 1ヶ月120分4回プラン
- [ ] プラン購入・登録機能
- [ ] プラン有効期限管理
- [ ] 残りセッション数管理
- [ ] 予約時に残り回数の確認・制限

#### 1.2 メニュー選択機能
- [ ] メニュー（大カテゴリ）選択
  - トレーニング
  - 整体
  - 鍼灸
  - 温活
  - 坐禅
- [ ] メニュー別の所要時間設定
- [ ] メニュー別の価格設定（オプション）

#### 1.3 時間枠機能
- [ ] 時間枠の設定（既存issue #4）
- [ ] メニューに応じた時間枠の動的表示

### 2. カルテ機能

#### 2.1 カルテ記録
- [ ] セッション中のカルテ入力（トレーナー）
- [ ] 大カテゴリ選択
- [ ] 中カテゴリ入力・選択
- [ ] 備考欄
- [ ] カルテ保存

#### 2.2 カルテ閲覧
- [ ] トレーニー用：自分のカルテ履歴閲覧
- [ ] トレーナー用：顧客のカルテ一覧・詳細
- [ ] カルテ検索・フィルタリング

### 3. 管理機能

#### 3.1 予約管理
- [ ] 予約一覧表示（全ユーザー）
- [ ] 予約ステータス管理
- [ ] 予約キャンセル処理
- [ ] 予約編集（日時変更など）

#### 3.2 ユーザー管理
- [ ] トレーニー一覧
- [ ] ユーザー詳細情報
- [ ] プラン購入履歴
- [ ] プラン有効期限管理

#### 3.3 プラン管理
- [ ] プラン一覧
- [ ] プラン作成・編集・削除
- [ ] プラン価格設定

#### 3.4 メニュー管理
- [ ] メニュー一覧
- [ ] メニュー作成・編集・削除
- [ ] メニューカテゴリ管理

### 4. 決済機能

#### 4.1 プラン購入時の決済
- [ ] 決済画面の実装
- [ ] 決済方法の選択（クレジットカード、銀行振込など）
- [ ] 決済API連携（Stripe、PayPal、または国内決済サービス）
- [ ] 決済ステータス管理
- [ ] 決済完了後のプラン有効化処理
- [ ] 決済履歴の記録

#### 4.2 決済管理
- [ ] 決済履歴の表示（トレーニー・トレーナー）
- [ ] 決済ステータスの確認
- [ ] 返金処理（オプション）

### 5. 認証・認可機能

#### 5.1 ロール管理
- [x] トレーナーロール（実装済み）
- [x] トレーニーロール（実装済み）
- [ ] ロール別アクセス制御（APIレベルでの実装は未対応）

#### 5.2 認証機能
- [x] トレーナーログイン（ロール選択可能）
- [x] トレーニーログイン（ロール選択可能）
- [ ] セッション管理（現状はローカルストレージでユーザーID管理）

### 5. 既存機能の拡張

#### 5.1 マイページ
- [ ] 個人情報編集（既存issue #7）
- [ ] プラン状況表示
- [ ] 残りセッション数表示
- [ ] 予約履歴
- [ ] カルテ履歴

## 実装優先度（案）

### フェーズ1（MVP）
1. ロール管理（トレーナー/トレーニー）
2. プラン機能（基本的なプラン選択・管理）
3. メニュー選択機能
4. 予約機能の拡張（プラン・メニュー対応）
5. 既存機能の拡張（キャンセル、フィルタリング、バリデーション、マイページ）

### フェーズ2
6. カルテ記録機能
7. カルテ閲覧機能
8. 管理機能（予約管理、ユーザー管理）

### フェーズ3
9. 決済機能（プラン購入時の決済処理 - Stripe連携）
10. プラン管理
11. メニュー管理
12. 統計・レポート機能
13. 決済機能の拡張（複数決済方法、返金処理など）

